define("app/utils/string",[],function(){String.prototype.format||(String.prototype.format=function(){var a=arguments;return this.replace(/{(\d+)}/g,function(b,c){return"undefined"!=typeof a[c]?a[c]:b})})}),define("app/utils/array",[],function(){Array.prototype.indexOf||(Array.prototype.indexOf=function(a){var b=this.length>>>0,c=Number(arguments[1])||0;for(c=0>c?Math.ceil(c):Math.floor(c),0>c&&(c+=b);b>c;c++)if(c in this&&this[c]===a)return c;return-1})}),define("app/image_preloader",["jquery"],function(a){function b(){this._waitLoading=null}return b.prototype.preload=function(b){var c=this,d=new Image,e=a.Deferred();return null!==c._waitLoading&&(c._waitLoading.onload=function(){},c._waitLoading=null),d.src=b,d.complete?e.resolve(b):(c._waitLoading=d,d.onload=function(){e.resolve(b),d.onload=function(){}}),e.promise()},b}),define("app/utils/random",[],function(){var a={};return a.getInt=function(a,b){return Math.floor(Math.random()*(b-a+1))+a},a}),define("app/app",["jquery","app/image_preloader","app/utils/random"],function(a,b,c){function d(){this.config={},e(s[c.getInt(0,2)])}function e(b){if(!m.hasClass("b-page_"+b)){m.removeClass(t.join(" ")),m.addClass("b-page_"+b),a(".char-text").hide(),a(".char-text_"+b).show(),a(".story__char").hide(),a("#story-"+b).show(),a(".info__char").hide(),a("#info-"+b).show();var c=a(".char");a.each(s,function(a,b){c.removeClass("char-"+b+"_selected")}),a(".char-"+b).addClass("char-"+b+"_selected");var d=a(".char-floated__image");a.each(s,function(a,b){d.removeClass("char-floated__image_"+b)}),d.addClass("char-floated__image_"+b),m.addClass("b-page_"+b),-1===v.indexOf(b)&&h(b),w.charFloated=[n.offset().top+n.height(),o.offset().top]}}function f(){var b=null;return a.each(s,function(a,c){m.hasClass("b-page_"+c)&&(b=c)}),b}function g(b){var c,d=f(),e=x[d],g=null;a(".char-state",q).hide().removeClass("char-state_selected"),a.each(e,function(a,d){var e=Math.abs(d.center-b);(null===g||g>e)&&(g=e,c=d.state)}),a.each(s,function(b,e){var f=a(".char-state-"+e+"-"+c,q);f.show(),e===d&&f.addClass("char-state_selected")})}function h(b){a("#info-"+b).find(".info-part").each(function(){var b=a(this),c=a(b.data("related")),d=b.outerHeight(),e=b.offset().top+d,f=c.offset().top+c.outerHeight(),g=d+(f-e);b.height(g)}),a("#story-"+b).find(".story__part").each(function(){var c=a(this),d=c.data("state"),e=c.offset().top+c.height()/2;x[b].push({$part:c,state:d,center:e})}),v.push(b)}function i(){var a=r.data("status");if(a)r.animate({left:u},"fast"),r.data("status",0);else{var b=j();r.animate({left:b},"fast"),r.data("status",1)}}function j(){var a=k.width(),b=r.offset().left,c=a-b;0>c&&(c=0);var d=a-c-200,e=870-c;d=0>d?0:d;var f=d>=e?e:d,g=b-f;return g>u?u:g}var k=a(window),l=a(document.body),m=a(".b-page",l),n=a(".switcher-top"),o=a(".switcher-bottom"),p=a(".char-floated"),q=a(".switcher-floated"),r=a(".layout__floated"),s=["yellow","red","blue"],t=["b-page_yellow","b-page_red","b-page_blue"],u=r.offset().left,v=[],w={charFloated:[0,0]},x={yellow:[],red:[],blue:[]};return d.prototype.init=function(){a(".switcher-top,.switcher-bottom").on("click",".char",function(){var b=a(this);switch(!0){case b.hasClass("char-yellow"):e("yellow");break;case b.hasClass("char-red"):e("red");break;case b.hasClass("char-blue"):e("blue")}if(b.closest(".switcher-bottom").length>0){var c=n.offset().top;l.add("html").animate({scrollTop:c},"slow")}return!1}),k.scroll(function(){var a=k.height(),b=k.scrollTop(),c=b+a,d=b+a/2;b>w.charFloated[0]&&c<w.charFloated[1]?(p.fadeIn("fast"),q.fadeIn("fast"),g(d)):(p.fadeOut("fast"),q.fadeOut("fast"))}),k.resize(function(){var a=r.data("status");if(a){var b=j();r.css({left:b+"px"})}}),a(".open-btn").on("click",i);var b=a(".char-text");a(".char",n).hover(function(){var c,d=a(this);b.hide(),a.each(s,function(a,b){d.hasClass("char-"+b)&&(c=b)}),b.filter(".char-text_"+c).show()},function(){var c=(a(this),f());b.hide(),b.filter(".char-text_"+c).show()}),a(".char-state").on("click",function(){var b=f(),c=a(this),d=null;a.each(s,function(a,b){-1!==c.attr("id").indexOf(b)&&(d=b)}),b!==d&&(e(d),a(".char-state_selected").removeClass("char-state_selected"),c.addClass("char-state_selected"))})},d}),define("app/modal",["jquery"],function(a){function b(b){this.$modal=b,d||(d=!0,c=a('<div class="modal__backdrop"></div>').appendTo(a("body"))),b.click(function(){a.each(e,function(a,b){b.hide()})}),a(".modal__dialog",b).click(function(){return!1})}var c=null,d=!1,e=[];return b.prototype.show=function(){this.$modal.show(),c.show(),e.push(this)},b.prototype.hide=function(){this.$modal.hide();var a=e.indexOf(this);-1!==a&&e.splice(a,1),0===e.length&&c.hide()},b}),define("app/init",["app/app","jquery","app/modal"],function(a,b,c){function d(){var a=new c(b("#modal"));b(".video-btn__btn").click(function(){a.show()})}var e=new a;b(function(){e.init(),d()})}),require.config({paths:{jquery:"//yandex.st/jquery/1.10.2/jquery.min"},shim:{}}),require(["app/utils/string"]),require(["app/utils/array"]),require(["app/init"]),define("main",function(){});
//# sourceMappingURL=build/app.min.map